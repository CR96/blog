---
import type { Post, Subject } from '../groq';
import type { PortableTextMarkDefinition } from "@portabletext/types";
import { resolveSanityRef } from '../util';

type Block = Extract<Post['content'][number], { '_type': 'block' }>;
interface NodeProps extends PortableTextMarkDefinition {
    markDef: Extract<NonNullable<Block['markDefs']>[number], { '_type': 'subject' }>;
}

const { markDef } : NodeProps = Astro.props.node;
const { subject: subjectRef } = markDef;

const subject = await resolveSanityRef<Subject>(subjectRef);
---

<a href={ `/subjects/${subject.slug.current}` }>
    <slot />
</a>