---
import type { Post } from '../groq';
import { Picture } from 'astro:assets';
import { sanityClient } from 'sanity:client';
import imageUrlBuilder from '@sanity/image-url';

interface Props {
    thumbnail: Post["thumbnail"]
};

const { thumbnail } = Astro.props;

if (!thumbnail) { return; }

const builder = imageUrlBuilder(sanityClient);
const thumbnailSrc = thumbnail && builder.image(thumbnail).url();
---

<Picture
    src={ thumbnailSrc }
    alt={ thumbnail.alt ?? '' }
    formats={ [ 'avif', 'jpeg' ] }
    fallbackFormat='jpeg'
    widths={ [ 540, 1080, 1520 ] }
    sizes={ `
        (max-width: 540px) 540px,
        (max-width: 1080px) 1080px,
        1520px
    ` }
    inferSize
/>
<style>
    img {
        width: 100%;
        object-fit: cover;
        aspect-ratio: 16 / 9;
    }
</style>