---
import { sanityClient } from 'sanity:client';
import imageUrlBuilder from '@sanity/image-url';
import CaptionedElement from './CaptionedElement.astro';

const { asset, alt = "", caption } = Astro.props.node;

const builder = imageUrlBuilder(sanityClient);
const src = builder.image(asset).format('webp').url();

const WrapperElement = caption ? CaptionedElement : Fragment;
---

<WrapperElement { ...caption && { caption } }>
    <img src={ src } alt={ alt } />
</WrapperElement>